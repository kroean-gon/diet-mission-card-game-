// âœ… ì´ˆê¸‰ìš© ì‚¬ì§„ ì¸ì¦ ì‹ë‹¨ ë¯¸ì…˜ 90ê°œ
const missions = [
  // 1) í•œ ë¼ ì¸ì¦ (15ê°œ)
  "ì˜¤ëŠ˜ ë¨¹ì€ í•œ ë¼ ì¸ì¦",
  "ì•„ì¹¨ ì‹ì‚¬ ì¸ì¦",
  "ì ì‹¬ ì‹ì‚¬ ì¸ì¦",
  "ì €ë… ì‹ì‚¬ ì¸ì¦",
  "ì§‘ë°¥ í•œ ë¼ ì¸ì¦",
  "ë°°ë‹¬ìŒì‹ í•œ ë¼ ì¸ì¦",
  "ì™¸ì‹ í•œ ë¼ ì¸ì¦",
  "ë„ì‹œë½ í•œ ë¼ ì¸ì¦",
  "ì¦‰ì„ì‹í’ˆ í•œ ë¼ ì¸ì¦",
  "ìƒëŸ¬ë“œ í•œ ë¼ ì¸ì¦",
  "ë°˜ì°¬ 3ê°€ì§€ ì´ìƒ ìžˆëŠ” í•œ ë¼ ì¸ì¦",
  "êµ­/ì°Œê°œ í¬í•¨ëœ í•œ ë¼ ì¸ì¦",
  "ë°¥ + ë°˜ì°¬ êµ¬ì„± ì¸ì¦",
  "ë©´ë¥˜ í•œ ë¼ ì¸ì¦",
  "ë¹µ ìœ„ì£¼ ì‹ì‚¬ ì¸ì¦",

  // 2) ì±„ì†Œ ì¤‘ì‹¬ (20ê°œ)
  "ì±„ì†Œ 1ê°€ì§€ ì´ìƒ ë³´ì´ëŠ” ì‹ë‹¨ ì¸ì¦",
  "ì±„ì†Œ 2ê°€ì§€ ì´ìƒ ë³´ì´ëŠ” ì‹ë‹¨ ì¸ì¦",
  "ì±„ì†Œ 3ê°€ì§€ ì´ìƒ ë³´ì´ëŠ” ì‹ë‹¨ ì¸ì¦",
  "ì´ˆë¡ìƒ‰ ì±„ì†Œ ì¸ì¦",
  "ë¹¨ê°„/ì£¼í™© ì±„ì†Œ ì¸ì¦",
  "ìƒëŸ¬ë“œ ì¸ì¦",
  "ë°ì¹œ ì±„ì†Œ ì¸ì¦",
  "ë‚˜ë¬¼ ë°˜ì°¬ ì¸ì¦",
  "ì˜¤ì´Â·ë°©ìš¸í† ë§ˆí†  ë“± ìƒì±„ì†Œ ì¸ì¦",
  "ê¹€ì¹˜ ì™¸ ì±„ì†Œ ë°˜ì°¬ ì¸ì¦",
  "êµ­ë¬¼ ì† ì±„ì†Œ ì¸ì¦",
  "ì±„ì†Œ í† í•‘ ë“¤ì–´ê°„ ë©”ë‰´ ì¸ì¦",
  "íŽ¸ì˜ì  ìƒëŸ¬ë“œ ì¸ì¦",
  "ì±„ì†Œë§Œ ë”°ë¡œ ëª¨ì•„ ì°ê¸°",
  "ì±„ì†Œ ì¶”ê°€í•œ ë©”ë‰´ ì¸ì¦",
  "í•œ ë¼ì— ì±„ì†Œë¥¼ ì¡°ê¸ˆì´ë¼ë„ ë‹´ì€ ì¸ì¦",
  "ì±„ì†Œ ë°˜ì°¬ 2ê°œ ì¸ì¦",
  "ì±„ì†Œ ë°˜ì°¬ 3ê°œ ì¸ì¦",
  "ìƒëŸ¬ë“œ + ë©”ì¸ ë©”ë‰´ ì¸ì¦",
  "ì˜¤ëŠ˜ ë¨¹ì€ ì±„ì†Œ ëª¨ì•„ì„œ í•œ ë²ˆì— ì¸ì¦",

  // 3) ë‹¨ë°±ì§ˆ ì¤‘ì‹¬ (20ê°œ)
  "ë‹¨ë°±ì§ˆ ë°˜ì°¬ 1ê°€ì§€ ì´ìƒ ì¸ì¦",
  "ë‹¨ë°±ì§ˆ ë°˜ì°¬ 2ê°€ì§€ ì´ìƒ ì¸ì¦",
  "ë‹¬ê±€ í¬í•¨í•œ ì‹ì‚¬ ì¸ì¦",
  "ê³„ëž€í›„ë¼ì´/ì‚¶ì€ê³„ëž€ ì¸ì¦",
  "ë‘ë¶€ ë“¤ì–´ê°„ ì‹ë‹¨ ì¸ì¦",
  "ì½©Â·ì½©ë‚˜ë¬¼ ë“± ì½©ë¥˜ ì¸ì¦",
  "ë‹­ê³ ê¸° ë“¤ì–´ê°„ ì‹ë‹¨ ì¸ì¦",
  "ì†Œê³ ê¸° í¬í•¨ ì‹ë‹¨ ì¸ì¦",
  "ë¼ì§€ê³ ê¸° í¬í•¨ ì‹ë‹¨ ì¸ì¦",
  "ìƒì„ /í•´ì‚°ë¬¼ ë©”ë‰´ ì¸ì¦",
  "ì°¸ì¹˜/ê³ ë“±ì–´ ìº” ì‹ë‹¨ ì¸ì¦",
  "ë‹¨ë°±ì§ˆ ê°„ì‹(ìš”ê±°íŠ¸ ë“±) ì¸ì¦",
  "ê·¸ë¦­ìš”ê±°íŠ¸ ì¸ì¦",
  "ì¹˜ì¦ˆ í¬í•¨ ì‹ë‹¨ ì¸ì¦",
  "íŽ¸ì˜ì  ë‹¨ë°±ì§ˆ ê°„ì‹ ì¸ì¦",
  "ë‹­ê°€ìŠ´ì‚´ ì œí’ˆ ì¸ì¦",
  "ë‹¨ë°±ì§ˆ ì‰ì´í¬ ì¸ì¦",
  "í”„ë¡œí‹´ë°” ì¸ì¦",
  "ë‹¨ë°±ì§ˆ 2ê°œ ì´ìƒ ë³´ì´ëŠ” ì‹ë‹¨ ì¸ì¦",
  "ë‹¨ë°±ì§ˆì´ ë©”ì¸ì¸ ë©”ë‰´ ì¸ì¦",

  // 4) ê°„ì‹Â·ìŒë£Œ (20ê°œ)
  "ê²¬ê³¼ë¥˜ ê°„ì‹ ì¸ì¦",
  "ìš”ê±°íŠ¸ ê°„ì‹ ì¸ì¦",
  "ê³¼ì¼ ê°„ì‹ ì¸ì¦",
  "ë°”ë‚˜ë‚˜ ì¸ì¦",
  "ì‚¬ê³¼ ì¸ì¦",
  "ê·¤/ì˜¤ë Œì§€ ì¸ì¦",
  "ë”¸ê¸° ì¸ì¦",
  "ì €ì¹¼ë¡œë¦¬ ê°„ì‹ ì¸ì¦",
  "ë‹¨ë°±ì§ˆ ê°„ì‹ ì¸ì¦",
  "ë¹µ ëŒ€ì‹  ì„ íƒí•œ ê±´ê°• ê°„ì‹ ì¸ì¦",
  "ì œë¡œìŒë£Œ ì¸ì¦",
  "ë¬¼ 1ì»µ ì¸ì¦",
  "ë¬¼ 2ì»µ ì´ìƒ ì¸ì¦",
  "ë”°ëœ»í•œ ë¬¼/ì°¨ ì¸ì¦",
  "ë¬´ê°€ë‹¹ ìŒë£Œ ì¸ì¦",
  "ì»¤í”¼(ì•„ë©”ë¦¬ì¹´ë…¸) ì¸ì¦",
  "ì¹´íŽ˜ì—ì„œ ë””ì €íŠ¸ ì—†ì´ ìŒë£Œë§Œ ì¸ì¦",
  "ì ¤ë¦¬/ìº”ë”” ëŒ€ì‹  ì„ íƒí•œ ê°„ì‹ ì¸ì¦",
  "íŽ¸ì˜ì  ê±´ê°• ê°„ì‹ 2ê°€ì§€ ì¸ì¦",
  "ì´ˆì½œë¦¿ ëŒ€ì‹  ì„ íƒí•œ ëŒ€ì²´ ê°„ì‹ ì¸ì¦",

  // 5) ìž¥ë³´ê¸°Â·ì‹ìž¬ë£Œ (15ê°œ)
  "ì±„ì†Œ ìž¥ë³´ê¸° ì¸ì¦",
  "ë‹¨ë°±ì§ˆ ìž¥ë³´ê¸° ì¸ì¦",
  "ê³„ëž€ ìž¥ë³´ê¸° ì¸ì¦",
  "ë‘ë¶€ ìž¥ë³´ê¸° ì¸ì¦",
  "ìƒëŸ¬ë“œ ìž¬ë£Œ ìž¥ë³´ê¸° ì¸ì¦",
  "ê±´ê°• ê°„ì‹ ìž¥ë°”êµ¬ë‹ˆ ì¸ì¦",
  "íŽ¸ì˜ì  ê±´ê°•í…œ 2ê°œ ì¸ì¦",
  "ëƒ‰ìž¥ê³  ê±´ê°• ì‹ìž¬ë£Œ ì •ë¦¬ ì¸ì¦",
  "ì§‘ì— ìžˆëŠ” ì‹ë‹¨í…œ íŽ¼ì³ë†“ê³  ì¸ì¦",
  "ì˜¤ëŠ˜ ì‚¬ ì˜¨ ì‹ë‹¨ ìž¬ë£Œ ì¸ì¦",
  "ì´ë²ˆ ì£¼ ì‚¬ìš©í•  ì±„ì†Œ ì¸ì¦",
  "ì´ë²ˆ ì£¼ ì‚¬ìš©í•  ë‹¨ë°±ì§ˆ ì¸ì¦",
  "ê³¼ì¼ ìž¥ë³´ê¸° ì¸ì¦",
  "ìŒë£Œ ëŒ€ì‹  ë¬¼/í‹° êµ¬ë§¤ ì¸ì¦",
  "ë¼ë©´ ëŒ€ì‹  ì„ íƒí•œ ìŒì‹ ì¸ì¦"
];

// ðŸŽµ íš¨ê³¼ìŒ (íŒŒì¼ì€ ë‚˜ì¤‘ì— card-deal.mp3 / card-flip.mp3 ì´ë¦„ìœ¼ë¡œ ì˜¬ë¦¬ë©´ ë¨)
const dealSound = new Audio("card-deal.mp3");
const flipSound = new Audio("card-flip.mp3");

function playSound(audio) {
  if (!audio) return;
  audio.currentTime = 0;
  audio.play().catch(() => {
    // ìžë™ìž¬ìƒ ë§‰íž˜ ë“± ì—ëŸ¬ëŠ” ë¬´ì‹œ
  });
}

// ì¹´ë“œ ìš”ì†Œë“¤
const dealBtn = document.getElementById("deal-btn");
const cards = Array.from(document.querySelectorAll(".card"));

let gameLocked = false; // í•œ ìž¥ ì„ íƒ í›„ ìž ê¸ˆ
let dealt = false;      // ì¹´ë“œê°€ íŽ¼ì³ì¡ŒëŠ”ì§€ ì—¬ë¶€

// ë°°ì—´ ì„žê¸°
function shuffleArray(array) {
  return array
    .map((item) => ({ value: item, sort: Math.random() }))
    .sort((a, b) => a.sort - b.sort)
    .map((item) => item.value);
}

// ì¹´ë“œ ë½‘ê¸° ë²„íŠ¼ í´ë¦­ ì‹œ
function dealCards() {
  gameLocked = false;
  dealt = true;

  // íš¨ê³¼ìŒ (ì´¤ë¥´ë¥µ)
  playSound(dealSound);

  // ì¹´ë“œ ì´ˆê¸°í™” + íŽ¼ì¹˜ê¸°
  cards.forEach((card) => {
    card.classList.remove("flipped", "disabled");
    card.classList.add("dealt");
  });

  // ë¯¸ì…˜ ì„žì–´ì„œ 3ê°œ ì„ íƒ
  const shuffled = shuffleArray(missions);
  const selected = shuffled.slice(0, 3);

  // ê° ì¹´ë“œì— ë¯¸ì…˜ ë„£ê¸°
  cards.forEach((card, index) => {
    const missionSpan = card.querySelector(".mission-text");
    missionSpan.textContent = selected[index];
  });
}

// ì¹´ë“œ í´ë¦­ ì‹œ
function onCardClick(event) {
  const card = event.currentTarget;

  if (!dealt) return;      // ì•„ì§ ë½‘ê¸° ì „ì´ë©´ ë¬´ì‹œ
  if (gameLocked) return;  // ì´ë¯¸ í•œ ìž¥ ì„ íƒí–ˆìœ¼ë©´ ë¬´ì‹œ

  // ì„ íƒí•œ ì¹´ë“œ ë’¤ì§‘ê¸°
  card.classList.add("flipped");
  playSound(flipSound); // ë’¤ì§‘ì„ ë•Œ íš¨ê³¼ìŒ

  gameLocked = true;

  // ë‚˜ë¨¸ì§€ ì¹´ë“œëŠ” íë¦¬ê²Œ ì²˜ë¦¬
  cards.forEach((c) => {
    if (c !== card) {
      c.classList.add("disabled");
    }
  });
}

// ì´ë²¤íŠ¸ ì—°ê²°
dealBtn.addEventListener("click", dealCards);
cards.forEach((card) => {
  card.addEventListener("click", onCardClick);
});
